<div class="space-y-6">
  <div class="sm:flex sm:items-center sm:justify-between">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Shops</h1>
      <p class="mt-2 text-sm text-gray-700">A list of all registered shops across all malls.</p>
    </div>
    <div class="mt-4 sm:mt-0">
      <%= link_to 'Add New Shop', new_shop_path, class: "inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" %>
    </div>
  </div>

  <div class="bg-white shadow border border-gray-200 sm:rounded-lg overflow-hidden">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shop Name</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location (Mall)</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
        </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
        <% @shops.each do |shop| %>
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center">
                <% if shop.logo.attached? %>
                  <div class="flex-shrink-0 h-10 w-10">
                    <%= image_tag shop.logo, class: "h-10 w-10 rounded-full object-cover" %>
                  </div>
                <% end %>
                <div class="<%= shop.logo.attached? ? 'ml-4' : '' %>">
                  <div class="text-sm font-medium text-gray-900"><%= shop.name %></div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-600"><%= shop.mall&.mall_name || 'Unassigned' %></div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex flex-wrap gap-1">
                <% shop.categories.each do |category| %>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    <%= category.category_name %>
                  </span>
                <% end %>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <% case shop.status %>
              <% when 'approved', 'active' %>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    <%= shop.status.titleize %>
                  </span>
              <% when 'pending' %>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                    <%= shop.status.titleize %>
                  </span>
              <% else %>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
<%= shop.status.present? ? shop.status.titleize : "No Status" %>
                  </span>
              <% end %>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
              <%= link_to 'View', shop, class: "text-blue-600 hover:text-blue-900" %>
              <%= link_to 'Edit', edit_shop_path(shop), class: "text-indigo-600 hover:text-indigo-900" %>
              
              <% if shop.pending? %>
                <%= button_to 'Approve', approve_shop_path(shop), method: :patch, class: "inline-block text-green-600 hover:text-green-900 bg-transparent border-0 cursor-pointer" %>
              <% end %>
              
              <% if shop.is_active? %>
                <%= button_to 'Deactivate', deactivate_shop_path(shop), method: :patch, class: "inline-block text-red-600 hover:text-red-900 bg-transparent border-0 cursor-pointer" %>
              <% else %>
                 <%= button_to 'Activate', activate_shop_path(shop), method: :patch, class: "inline-block text-green-600 hover:text-green-900 bg-transparent border-0 cursor-pointer" %>
              <% end %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>

    <div class="bg-white px-4 py-3 border-t border-gray-200 sm:px-6">
      <div class="text-sm text-gray-700">
        <%= paginate @shops if @shops.respond_to?(:total_pages) %>
      </div>
    </div>
  </div>
</div>