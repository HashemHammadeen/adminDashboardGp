<div class="space-y-6">
  <div class="md:flex md:items-center md:justify-between">
    <div class="flex-1 min-w-0">
      <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate">System Configuration</h2>
    </div>
  </div>

  <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
    <!-- Point Value Configuration -->
    <div class="bg-white shadow sm:rounded-lg">
      <div class="px-4 py-5 sm:p-6">
        <h3 class="text-lg leading-6 font-medium text-gray-900">Point Value</h3>
        <div class="mt-2 max-w-xl text-sm text-gray-500">
          <p>Set the monetary value of a single loyalty point.</p>
        </div>
        <%= form_with url: update_configurations_path, method: :patch, class: "mt-5 sm:flex sm:items-center" do |f| %>
          <%= f.hidden_field :key, value: 'point_value' %>
          <div class="w-full sm:max-w-xs">
            <%= f.label :value, "Value (Currency)", class: "sr-only" %>
            <%= f.number_field :value, value: @point_value, step: "0.0001", class: "shadow-sm focus:ring-primary focus:border-primary block w-full sm:text-sm border-gray-300 rounded-md", placeholder: "0.01" %>
          </div>
          <div class="mt-3 w-full sm:mt-0 sm:ml-3 sm:w-auto">
            <%= f.text_field :reason, placeholder: "Reason for change", class: "shadow-sm focus:ring-primary focus:border-primary block w-full sm:text-sm border-gray-300 rounded-md mb-2 sm:mb-0" %>
          </div>
          <%= f.submit "Save", class: "mt-3 w-full inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm font-medium rounded-md text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm" %>
        <% end %>
      </div>
    </div>

    <!-- Expiration Policy Configuration -->
    <div class="bg-white shadow sm:rounded-lg">
      <div class="px-4 py-5 sm:p-6">
        <h3 class="text-lg leading-6 font-medium text-gray-900">Expiration Policy</h3>
        <div class="mt-2 max-w-xl text-sm text-gray-500">
          <p>Set the number of days before points expire after inactivity.</p>
        </div>
        <%= form_with url: update_configurations_path, method: :patch, class: "mt-5 sm:flex sm:items-center" do |f| %>
          <%= f.hidden_field :key, value: 'expiration_days' %>
          <div class="w-full sm:max-w-xs">
            <%= f.label :value, "Days", class: "sr-only" %>
            <%= f.number_field :value, value: @expiration_days, class: "shadow-sm focus:ring-primary focus:border-primary block w-full sm:text-sm border-gray-300 rounded-md", placeholder: "365" %>
          </div>
          <%= f.submit "Save", class: "mt-3 w-full inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm font-medium rounded-md text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm" %>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Audit Log -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900">Configuration History</h3>
      <p class="mt-1 max-w-2xl text-sm text-gray-500">Audit log of recent changes to point values.</p>
    </div>
    <div class="border-t border-gray-200">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Old Value</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">New Value</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reason</th>
        </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
        <% @history.each do |log| %>
          <tr>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= log.effective_date.strftime("%b %d, %Y %H:%M") %></td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= log.old_value %></td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"><%= log.new_value %></td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= log.reason %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
